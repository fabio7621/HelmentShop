import{_ as B,m as w,a as I,c,e as n,d as M,b as e,w as x,r as u,F as L,f as T,t as p,j as y,v as V,p as U,n as E,o as m,g as _,i as z,D as g}from"./index-B2CUwak0.js";import{c as k}from"./cartStore-CWo_eutF.js";import{L as F}from"./Loadingitem-BtKMH2zq.js";import{u as H}from"./toastMessage-CgHJWb5D.js";import{_ as P,a as G}from"./banner-p05-f1rL14bm.js";import{_ as N}from"./home-BL8hcX6S.js";import{_ as O}from"./motohead-BtBMMVQo.js";const D="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2025.0.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='圖層_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%2021.95%2028.23'%20style='enable-background:new%200%200%2021.95%2028.23;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23C50500;}%20%3c/style%3e%3cpath%20id='Icon_material-delete-forever'%20class='st0'%20d='M1.57,25.09c0,1.73,1.4,3.13,3.13,3.14h12.55c1.73,0,3.13-1.41,3.14-3.14%20V6.27H1.57V25.09z%20M5.42,13.93l2.21-2.21l3.34,3.32l3.32-3.32l2.21,2.21l-3.32,3.32l3.32,3.32l-2.21,2.21l-3.32-3.32l-3.32,3.32%20l-2.21-2.21l3.32-3.32L5.42,13.93z%20M16.46,1.57L14.9,0H7.06L5.49,1.57H0V4.7h21.95V1.57H16.46z'/%3e%3c/svg%3e",j="/HelmentShop/assets/nocart-BO513kld.png",J={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_APIPATH:"fabio20"},{VITE_API:v,VITE_APIPATH:b}=J,K={data(){return{isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon_code:"",coupon_status:!1}},computed:{...w(k,["carts","final_total","total"])},methods:{...I(k,["getCart"]),...I(H,["pushMessage"]),restInput(s){s.qty<=0&&(s.qty=1)},removeCartItem(s){const t=`${v}api/${b}/cart/${s}`;this.$http.delete(t).then(i=>{this.getCart()}).catch(i=>{alert(`${err.response.data.message}`)})},createOrder(){const s=`${v}api/${b}/order`,t=this.form;this.$http.post(s,{data:t}).then(i=>{this.getCart(),this.$refs.form.resetForm(),this.$router.push(`/myorder/${i.data.orderId}`)}).catch(i=>{alert(`${err.response.data.message}`)})},updateCart(s){const t=`${v}api/${b}/cart/${s.id}`,i={product_id:s.product_id,qty:s.qty};this.$http.put(t,{data:i}).then(C=>{this.getCart()}).catch(C=>{alert(`更新購物車失敗${err.response.data.message}`)})},addCouponCode(){const s=`${v}api/${b}/coupon`,t={code:this.coupon_code};this.isLoading=!0,this.$http.post(s,{data:t}).then(i=>{this.pushMessage({style:"success",title:"加入優惠券",content:i.data.message}),this.getCart(),this.isLoading=!1,this.coupon_status=!0}).catch(i=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"加入優惠券",content:i.response.data.message})})},deleteAllCarts(){this.isLoading=!0,this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/fabio20/carts").then(t=>{this.getCart(),this.isLoading=!1}).catch(t=>{this.isLoading=!1,alert(`清除購物車${t.response.data.message}`)})}},components:{...w(k,["carts"]),Loadingitem:F},mounted(){this.getCart(),this.coupon_code=this.$route.params.couponid}},d=s=>(U("data-v-2d05a9d7"),s=s(),E(),s),Q=M('<section class="section-main-banner" data-v-2d05a9d7><img class="d-none d-md-block w-100" src="'+P+'" alt="banner" data-v-2d05a9d7><img class="d-block d-md-none w-100" src="'+G+'" alt="banner" data-v-2d05a9d7></section><section class="section-bread" data-v-2d05a9d7><div class="section-bread-main" data-v-2d05a9d7><ol class="bread-list d-flex align-items-center" data-v-2d05a9d7><li class="bread-list-item" data-v-2d05a9d7><div class="section-bread-pic" data-v-2d05a9d7><img width="20" src="'+N+'" alt="homepic" data-v-2d05a9d7></div></li><li class="bread-list-item" aria-current="page" data-v-2d05a9d7><a data-v-2d05a9d7>購物車</a></li></ol></div></section>',2),R={class:"section-product"},W={key:0,class:"section-product-main"},X=d(()=>e("div",{class:"section-product-title d-flex align-items-center"},[e("div",{class:"product-title-pic"},[e("img",{src:O,alt:"title pic"})]),e("h2",null,"購物車")],-1)),Y={class:"article-box"},Z={class:"section-checkout-carts"},ee=d(()=>e("thead",null,[e("tr",null,[e("th",null,"品項"),e("th",{class:"text-start pe-4"},"數量"),e("th",null,"刪除"),e("th",{class:"text-end pe-4"},"小計")])],-1)),te={class:"d-flex align-items-center"},se=["src"],oe=d(()=>e("br",null,null,-1)),ae={style:{"font-size":"12px"}},le=d(()=>e("br",null,null,-1)),ne={key:0,class:"text-end text-success"},de={class:"align-middle p-0"},ie={class:"input-group"},re={class:"form-floating"},ce=["onUpdate:modelValue","onBlur","onInput"],me=d(()=>e("label",{for:"floatingInputGroup1"},null,-1)),ue={style:{"font-weight":"300","font-size":"13px"},class:"input-group-text"},pe={class:"align-middle"},_e=["onClick"],he=d(()=>e("img",{src:D,alt:"delreBtn"},null,-1)),fe=[he],ge={class:"align-middle text-end"},ve={class:"checkout-total d-flex flex-row-reverse"},be={class:"checkout-total-price d-flex"},xe={key:0,class:"text-end text-success"},ye={key:1},Ve={class:"mt-3 mb-5 d-flex justify-content-end"},ke={class:"input-group-append"},Ce={class:"section-checkout-order"},we={class:"checkout-order-main"},Ie={class:"section-order-item"},Le=d(()=>e("label",{class:"mb-md-3 mb-3",for:"email"},[e("span",null,"＊"),_("email ")],-1)),$e={class:"section-order-item"},Se=d(()=>e("label",{class:"mb-md-3 mb-3",for:"yourname"},[e("span",null,"＊"),_("收件人姓名 ")],-1)),qe={class:"section-order-item"},Ae=d(()=>e("label",{class:"mb-md-3 mb-3",for:""},[e("span",null,"＊"),_("收件人電話 ")],-1)),Be={class:"section-order-item"},Me=d(()=>e("label",{class:"mb-md-3 mb-3",for:""},[e("span",null,"＊"),_("收件人地址 ")],-1)),Te={class:"section-order-item"},Ue=d(()=>e("label",{class:"mb-md-3 mb-3",for:""},"留言",-1)),Ee={key:1,class:"section-product-main pt-5 pb-5"},ze=d(()=>e("img",{class:"img-fluid d-block mx-auto",src:j,alt:"clean cart"},null,-1)),Fe=[ze];function He(s,t,i,C,a,r){const $=u("Loadingitem"),S=u("VueLoading"),q=u("router-link"),h=u("VeeField"),f=u("ErrorMessage"),A=u("VeeForm");return m(),c(L,null,[n(S,{active:a.isLoading,"z-index":1060},{default:x(()=>[n($)]),_:1},8,["active"]),Q,e("section",R,[s.carts.length!==0?(m(),c("div",W,[X,e("div",Y,[e("table",Z,[ee,e("tbody",null,[(m(!0),c(L,null,T(s.carts,o=>(m(),c("tr",{key:o.product_id},[e("td",te,[n(q,{to:`/product/${o.product_id}`,class:"d-block cart-pic"},{default:x(()=>[e("img",{src:o.product.imageUrl,alt:"productImg"},null,8,se)]),_:2},1032,["to"]),e("p",null,[_(p(o.product.title),1),oe,e("span",ae,p(`單價${o.product.price}元/${o.product.unit}`),1),le,a.coupon_status?(m(),c("small",ne,"已套用折扣卷")):z("",!0)])]),e("td",de,[e("div",ie,[e("div",re,[y(e("input",{type:"number",class:"form-control p-0",style:{"text-indent":"1em"},id:"floatingInputGroup1","onUpdate:modelValue":l=>o.qty=l,onBlur:l=>r.updateCart(o),onInput:l=>r.restInput(o),min:"0"},null,40,ce),[[V,o.qty,void 0,{number:!0}]]),me]),e("span",ue,p(o.product.unit),1)])]),e("td",pe,[e("div",{onClick:l=>r.removeCartItem(o.id),class:"cart-del mx-auto"},fe,8,_e)]),e("td",ge,[e("span",null,p(s.$filters.currency(o.final_total))+"元",1)])]))),128))])]),e("button",{onClick:t[0]||(t[0]=o=>r.deleteAllCarts()),type:"button",class:"cleanCartBtn btn ms-auto mt-2"},"清空購物車"),e("div",ve,[e("div",be,[a.coupon_status?(m(),c("p",xe,"優惠價")):(m(),c("p",ye,"總金額")),e("span",null,"$"+p(s.$filters.currency(s.final_total))+"元",1)])]),e("div",Ve,[y(e("input",{type:"text",class:"form-control w-50","onUpdate:modelValue":t[1]||(t[1]=o=>a.coupon_code=o),placeholder:"請輸入優惠碼",style:{"max-width":"300px"}},null,512),[[V,a.coupon_code]]),e("div",ke,[e("button",{class:"ms-1 btn btn-outline-secondary",type:"button",onClick:t[2]||(t[2]=(...o)=>r.addCouponCode&&r.addCouponCode(...o))},"使用優惠碼")])]),e("div",Ce,[e("div",we,[n(A,{onSubmit:r.createOrder,ref:"form",class:"checkout-order-box",action:""},{default:x(({errors:o})=>[e("div",Ie,[Le,n(h,{type:"email",name:"email",class:g(["w-100 mb-md-3 mb-1 form-control",{"is-invalid":o.email}]),id:"email",placeholder:"email",rules:"email|required",modelValue:a.form.user.email,"onUpdate:modelValue":t[3]||(t[3]=l=>a.form.user.email=l)},null,8,["class","modelValue"]),n(f,{name:"email",class:"invalid-feedback mb-2"})]),e("div",$e,[Se,n(h,{class:g([{"is-invalid":o.姓名},"w-100 mb-md-3 mb-1 form-control"]),placeholder:"收件人姓名",rules:"required",type:"text",id:"yourname",name:"姓名",modelValue:a.form.user.name,"onUpdate:modelValue":t[4]||(t[4]=l=>a.form.user.name=l)},null,8,["class","modelValue"]),n(f,{name:"姓名",class:"invalid-feedback mb-2"})]),e("div",qe,[Ae,n(h,{class:g([{"is-invalid":o.電話},"w-100 mb-md-3 mb-1 form-control"]),placeholder:"收件人電話",rules:"required|min:8|max:10",type:"tel",modelValue:a.form.user.tel,"onUpdate:modelValue":t[5]||(t[5]=l=>a.form.user.tel=l),name:"電話"},null,8,["class","modelValue"]),n(f,{name:"電話",class:"invalid-feedback mb-2"})]),e("div",Be,[Me,n(h,{class:g([{"is-invalid":o.地址},"w-100 mb-md-3 mb-1 form-control"]),placeholder:"請輸入地址",rules:"required",type:"text",modelValue:a.form.user.address,"onUpdate:modelValue":t[6]||(t[6]=l=>a.form.user.address=l),name:"地址"},null,8,["class","modelValue"]),n(f,{name:"地址",class:"invalid-feedback mb-2"})]),e("div",Te,[Ue,y(e("textarea",{class:"w-100 form-control",name:"",id:"",rows:"10","onUpdate:modelValue":t[7]||(t[7]=l=>a.form.message=l)},null,512),[[V,a.form.message]])]),e("button",{onClick:t[8]||(t[8]=l=>r.createOrder()),class:"checkout-pay-order-btn w-100"},"確認送出")]),_:1},8,["onSubmit"])])])])])):(m(),c("div",Ee,Fe))])],64)}const Ke=B(K,[["render",He],["__scopeId","data-v-2d05a9d7"]]);export{Ke as default};
