import{m as L,a as U,u as T,r as p,d as n,w as V,f as t,b as m,i as E,e as b,g as f,h as g,D as H,E as P}from"./index-Cfi2m2dj.js";import{c as y}from"./cartStore-DTUi49ll.js";import{_ as R}from"./Loadingitem-mQZmHoWz.js";import{u as z}from"./toastMessage-Bd_7BpTT.js";import{_ as F,a as B}from"./banner-p05-f1rL14bm.js";import{_ as G}from"./home-BL8hcX6S.js";import{_}from"./motohead-BtBMMVQo.js";const O="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2025.0.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='圖層_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%2021.95%2028.23'%20style='enable-background:new%200%200%2021.95%2028.23;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23C50500;}%20%3c/style%3e%3cpath%20id='Icon_material-delete-forever'%20class='st0'%20d='M1.57,25.09c0,1.73,1.4,3.13,3.13,3.14h12.55c1.73,0,3.13-1.41,3.14-3.14%20V6.27H1.57V25.09z%20M5.42,13.93l2.21-2.21l3.34,3.32l3.32-3.32l2.21,2.21l-3.32,3.32l3.32,3.32l-2.21,2.21l-3.32-3.32l-3.32,3.32%20l-2.21-2.21l3.32-3.32L5.42,13.93z%20M16.46,1.57L14.9,0H7.06L5.49,1.57H0V4.7h21.95V1.57H16.46z'/%3e%3c/svg%3e",D="/HelmentShop/assets/nocart-BO513kld.png",N={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_APIPATH:"fabio20"},{VITE_API:h,VITE_APIPATH:x}=N,$={data(){return{isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon_code:"",coupon_status:!1}},computed:{...L(y,["carts","final_total","total"])},methods:{...U(y,["getCart"]),...U(z,["pushMessage"]),restInput(l){l.qty<=0&&(l.qty=1)},removeCartItem(l){const a=`${h}api/${x}/cart/${l}`;this.$http.delete(a).then(r=>{this.getCart()}).catch(r=>{alert(`${err.response.data.message}`)})},createOrder(){const l=`${h}api/${x}/order`,a=this.form;this.$http.post(l,{data:a}).then(r=>{this.getCart(),this.$refs.form.resetForm(),this.$router.push(`/myorder/${r.data.orderId}`)}).catch(r=>{alert(`${err.response.data.message}`)})},updateCart(l){const a=`${h}api/${x}/cart/${l.id}`,r={product_id:l.product_id,qty:l.qty};this.$http.put(a,{data:r}).then(w=>{this.getCart()}).catch(w=>{alert(`更新購物車失敗${err.response.data.message}`)})},addCouponCode(){const l=`${h}api/${x}/coupon`,a={code:this.coupon_code};this.isLoading=!0,this.$http.post(l,{data:a}).then(r=>{this.pushMessage({style:"success",title:"加入優惠券",content:r.data.message}),this.getCart(),this.isLoading=!1,this.coupon_status=!0}).catch(r=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"加入優惠券",content:r.response.data.message})})},deleteAllCarts(){this.isLoading=!0,this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/fabio20/carts").then(a=>{this.getCart(),this.isLoading=!1}).catch(a=>{this.isLoading=!1,alert(`清除購物車${a.response.data.message}`)})}},components:{...L(y,["carts"]),Loadingitem:R},mounted(){this.getCart(),this.coupon_code=this.$route.params.couponid}};function j(l,a,r,w,J,K,s,k){const S=p("VueLoading"),C=p("Loadingitem"),A=p("router-link"),M=p("VeeForm"),u=p("VeeField"),v=p("ErrorMessage");a("<!--[-->"),a(n(S,{active:s.isLoading,"z-index":1060},{default:V((o,c,i,e)=>{if(c)c(n(C,null,null,i,e));else return[t(C)]}),_:1},r)),a(`<section class="section-main-banner" data-v-738a3dc6><img class="d-none d-md-block w-100"${m("src",F)} alt="banner" data-v-738a3dc6><img class="d-block d-md-none w-100"${m("src",B)} alt="banner" data-v-738a3dc6></section><section class="section-bread" data-v-738a3dc6><div class="section-bread-main" data-v-738a3dc6><ol class="bread-list d-flex align-items-center" data-v-738a3dc6><li class="bread-list-item" data-v-738a3dc6><div class="section-bread-pic" data-v-738a3dc6><img width="20"${m("src",G)} alt="homepic" data-v-738a3dc6></div></li><li class="bread-list-item" aria-current="page" data-v-738a3dc6><a data-v-738a3dc6>購物車</a></li></ol></div></section><section class="section-product" data-v-738a3dc6>`),l.carts.length!==0?(a(`<div class="section-product-main" data-v-738a3dc6><div class="section-product-title d-flex align-items-center" data-v-738a3dc6><div class="product-title-pic" data-v-738a3dc6><img${m("src",_)} alt="title pic" data-v-738a3dc6></div><h2 data-v-738a3dc6>購物車</h2></div><div class="article-box" data-v-738a3dc6><table class="section-checkout-carts" data-v-738a3dc6><thead data-v-738a3dc6><tr data-v-738a3dc6><th data-v-738a3dc6>品項</th><th class="text-start pe-4" data-v-738a3dc6>數量</th><th data-v-738a3dc6>刪除</th><th class="text-end pe-4" data-v-738a3dc6>小計</th></tr></thead><tbody data-v-738a3dc6><!--[-->`),E(l.carts,o=>{a('<tr data-v-738a3dc6><td class="d-flex align-items-center" data-v-738a3dc6>'),a(n(A,{to:`/product/${o.product_id}`,class:"d-block cart-pic"},{default:V((c,i,e,d)=>{if(i)i(`<img${m("src",o.product.imageUrl)} alt="productImg" data-v-738a3dc6${d}>`);else return[t("img",{src:o.product.imageUrl,alt:"productImg"},null,8,["src"])]}),_:2},r)),a(`<p data-v-738a3dc6>${b(o.product.title)}<br data-v-738a3dc6><span style="${f({"font-size":"12px"})}" data-v-738a3dc6>${b(`單價${o.product.price}元/${o.product.unit}`)}</span><br data-v-738a3dc6>`),s.coupon_status?a('<small class="text-end text-success" data-v-738a3dc6>已套用折扣卷</small>'):a("<!---->"),a(`</p></td><td class="align-middle p-0" data-v-738a3dc6><div class="input-group" data-v-738a3dc6><div class="form-floating" data-v-738a3dc6><input type="number" class="form-control p-0" style="${f({"text-indent":"1em"})}" id="floatingInputGroup1"${m("value",o.qty)} min="0" data-v-738a3dc6><label for="floatingInputGroup1" data-v-738a3dc6></label></div><span style="${f({"font-weight":"300","font-size":"13px"})}" class="input-group-text" data-v-738a3dc6>${b(o.product.unit)}</span></div></td><td class="align-middle" data-v-738a3dc6><div class="cart-del mx-auto" data-v-738a3dc6><img${m("src",O)} alt="delreBtn" data-v-738a3dc6></div></td><td class="align-middle text-end" data-v-738a3dc6><span data-v-738a3dc6>${b(l.$filters.currency(o.final_total))}元</span></td></tr>`)}),a('<!--]--></tbody></table><button type="button" class="cleanCartBtn btn ms-auto mt-2" data-v-738a3dc6>清空購物車</button><div class="checkout-total d-flex flex-row-reverse" data-v-738a3dc6><div class="checkout-total-price d-flex" data-v-738a3dc6>'),s.coupon_status?a('<p class="text-end text-success" data-v-738a3dc6>優惠價</p>'):a("<p data-v-738a3dc6>總金額</p>"),a(`<span data-v-738a3dc6>$${b(l.$filters.currency(l.final_total))}元</span></div></div><div class="mt-3 mb-5 d-flex justify-content-end" data-v-738a3dc6><input type="text" class="form-control w-50"${m("value",s.coupon_code)} placeholder="請輸入優惠碼" style="${f({"max-width":"300px"})}" data-v-738a3dc6><div class="input-group-append" data-v-738a3dc6><button class="ms-1 btn btn-outline-secondary" type="button" data-v-738a3dc6>使用優惠碼</button></div></div><div class="section-checkout-order" data-v-738a3dc6><div class="checkout-order-main" data-v-738a3dc6>`),a(n(M,{onSubmit:k.createOrder,ref:"form",class:"checkout-order-box",action:""},{default:V(({errors:o},c,i,e)=>{if(c)c(`<div class="section-order-item" data-v-738a3dc6${e}><label class="mb-md-3 mb-3" for="email" data-v-738a3dc6${e}><span data-v-738a3dc6${e}>＊</span>email </label>`),c(n(u,{type:"email",name:"email",class:["w-100 mb-md-3 mb-1 form-control",{"is-invalid":o.email}],id:"email",placeholder:"email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":d=>s.form.user.email=d},null,i,e)),c(n(v,{name:"email",class:"invalid-feedback mb-2"},null,i,e)),c(`</div><div class="section-order-item" data-v-738a3dc6${e}><label class="mb-md-3 mb-3" for="yourname" data-v-738a3dc6${e}><span data-v-738a3dc6${e}>＊</span>收件人姓名 </label>`),c(n(u,{class:[{"is-invalid":o.姓名},"w-100 mb-md-3 mb-1 form-control"],placeholder:"收件人姓名",rules:"required",type:"text",id:"yourname",name:"姓名",modelValue:s.form.user.name,"onUpdate:modelValue":d=>s.form.user.name=d},null,i,e)),c(n(v,{name:"姓名",class:"invalid-feedback mb-2"},null,i,e)),c(`</div><div class="section-order-item" data-v-738a3dc6${e}><label class="mb-md-3 mb-3" for="" data-v-738a3dc6${e}><span data-v-738a3dc6${e}>＊</span>收件人電話 </label>`),c(n(u,{class:[{"is-invalid":o.電話},"w-100 mb-md-3 mb-1 form-control"],placeholder:"收件人電話",rules:"required|min:8|max:10",type:"tel",modelValue:s.form.user.tel,"onUpdate:modelValue":d=>s.form.user.tel=d,name:"電話"},null,i,e)),c(n(v,{name:"電話",class:"invalid-feedback mb-2"},null,i,e)),c(`</div><div class="section-order-item" data-v-738a3dc6${e}><label class="mb-md-3 mb-3" for="" data-v-738a3dc6${e}><span data-v-738a3dc6${e}>＊</span>收件人地址 </label>`),c(n(u,{class:[{"is-invalid":o.地址},"w-100 mb-md-3 mb-1 form-control"],placeholder:"請輸入地址",rules:"required",type:"text",modelValue:s.form.user.address,"onUpdate:modelValue":d=>s.form.user.address=d,name:"地址"},null,i,e)),c(n(v,{name:"地址",class:"invalid-feedback mb-2"},null,i,e)),c(`</div><div class="section-order-item" data-v-738a3dc6${e}><label class="mb-md-3 mb-3" for="" data-v-738a3dc6${e}>留言</label><textarea class="w-100 form-control" name="" id="" rows="10" data-v-738a3dc6${e}>${b(s.form.message)}</textarea></div><button class="checkout-pay-order-btn w-100" data-v-738a3dc6${e}>確認送出</button>`);else return[t("div",{class:"section-order-item"},[t("label",{class:"mb-md-3 mb-3",for:"email"},[t("span",null,"＊"),g("email ")]),t(u,{type:"email",name:"email",class:["w-100 mb-md-3 mb-1 form-control",{"is-invalid":o.email}],id:"email",placeholder:"email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":d=>s.form.user.email=d},null,8,["class","modelValue","onUpdate:modelValue"]),t(v,{name:"email",class:"invalid-feedback mb-2"})]),t("div",{class:"section-order-item"},[t("label",{class:"mb-md-3 mb-3",for:"yourname"},[t("span",null,"＊"),g("收件人姓名 ")]),t(u,{class:[{"is-invalid":o.姓名},"w-100 mb-md-3 mb-1 form-control"],placeholder:"收件人姓名",rules:"required",type:"text",id:"yourname",name:"姓名",modelValue:s.form.user.name,"onUpdate:modelValue":d=>s.form.user.name=d},null,8,["class","modelValue","onUpdate:modelValue"]),t(v,{name:"姓名",class:"invalid-feedback mb-2"})]),t("div",{class:"section-order-item"},[t("label",{class:"mb-md-3 mb-3",for:""},[t("span",null,"＊"),g("收件人電話 ")]),t(u,{class:[{"is-invalid":o.電話},"w-100 mb-md-3 mb-1 form-control"],placeholder:"收件人電話",rules:"required|min:8|max:10",type:"tel",modelValue:s.form.user.tel,"onUpdate:modelValue":d=>s.form.user.tel=d,name:"電話"},null,8,["class","modelValue","onUpdate:modelValue"]),t(v,{name:"電話",class:"invalid-feedback mb-2"})]),t("div",{class:"section-order-item"},[t("label",{class:"mb-md-3 mb-3",for:""},[t("span",null,"＊"),g("收件人地址 ")]),t(u,{class:[{"is-invalid":o.地址},"w-100 mb-md-3 mb-1 form-control"],placeholder:"請輸入地址",rules:"required",type:"text",modelValue:s.form.user.address,"onUpdate:modelValue":d=>s.form.user.address=d,name:"地址"},null,8,["class","modelValue","onUpdate:modelValue"]),t(v,{name:"地址",class:"invalid-feedback mb-2"})]),t("div",{class:"section-order-item"},[t("label",{class:"mb-md-3 mb-3",for:""},"留言"),H(t("textarea",{class:"w-100 form-control",name:"",id:"",rows:"10","onUpdate:modelValue":d=>s.form.message=d},null,8,["onUpdate:modelValue"]),[[P,s.form.message]])]),t("button",{onClick:d=>k.createOrder(),class:"checkout-pay-order-btn w-100"},"確認送出",8,["onClick"])]}),_:1},r)),a("</div></div></div></div>")):a(`<div class="section-product-main pt-5 pb-5" data-v-738a3dc6><img class="img-fluid d-block mx-auto"${m("src",D)} alt="clean cart" data-v-738a3dc6></div>`),a("</section><!--]-->")}$.ssrRender=j;$.__scopeId="data-v-738a3dc6";const q=$.setup;$.setup=(l,a)=>{const r=T();return(r.modules||(r.modules=new Set)).add("src/views/FrontView/CheckoutView.vue"),q?q(l,a):void 0};export{$ as default};
